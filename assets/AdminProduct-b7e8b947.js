import{m as C}from"./modal-026801b7.js";import{_ as D,o as a,c as i,a as t,j as n,D as r,F as f,h as x,i as A,H as $,b as E,t as u,B as S,C as T,m as I,f as L,r as y,d as U,n as k,G as w}from"./index-2c34bb4a.js";import{a as N}from"./alertStore-84118eea.js";const R={props:["tempProduct","isNew","updateData","createImages"]},B={class:"modal fade",id:"productModal",ref:"productModal"},H={class:"modal-dialog"},F={class:"modal-content"},O={class:"modal-header bg-primary"},j={key:0,class:"modal-title text-white"},z={key:1,class:"modal-title text-white"},q=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},X={class:"row"},J={class:"col-md-4 col-sm-5"},K={class:"mb-3"},Q=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),W=["src"],Y=t("h3",{class:"mb-3"},"多圖新增",-1),Z={key:0},tt=t("label",{for:"imageUrl",class:"form-label"},"新增圖片",-1),et=["onUpdate:modelValue"],ot={key:0,class:"imagesUrl"},st=["onClick"],lt=["src"],dt={class:"col-md-8 col-sm-7"},at={class:"mb-3"},it=t("label",{for:"title",class:"form-label"},"標題",-1),nt={class:"row"},ct={class:"col-md-6"},rt=t("label",{for:"category",class:"form-label"},"分類",-1),mt={class:"col-md-6"},ut=t("label",{for:"unit",class:"form-label"},"單位",-1),ht={class:"row"},_t={class:"col-md-6"},pt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),bt={class:"col-md-6"},gt=t("label",{for:"price",class:"form-label"},"售價",-1),Pt=t("hr",null,null,-1),ft={class:"mb-3"},vt=t("label",{for:"description",class:"form-label"},"產品描述",-1),yt={class:"mb-3"},Ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),kt={class:"mb-3"},wt={class:"form-check"},Vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),xt={class:"modal-footer"},Dt=t("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal"},"取消",-1);function Ct(s,e,o,p,h,c){return a(),i("div",B,[t("div",H,[t("div",F,[t("div",O,[o.isNew?(a(),i("h5",j,"新增產品")):(a(),i("h5",z,"編輯產品")),q]),t("div",G,[t("div",X,[t("div",J,[t("div",K,[Q,n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.tempProduct.imageUrl=l),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[r,o.tempProduct.imageUrl]]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl},null,8,W)]),Y,t("div",null,[Array.isArray(o.tempProduct.imagesUrl)?(a(),i("div",Z,[(a(!0),i(f,null,x(o.tempProduct.imagesUrl,(l,m)=>(a(),i("div",{class:"mb-3",key:m},[t("div",null,[tt,n(t("input",{"onUpdate:modelValue":b=>o.tempProduct.imagesUrl[m]=b,type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,8,et),[[r,o.tempProduct.imagesUrl[m]]])]),o.tempProduct.imagesUrl[m]?(a(),i("div",ot,[t("button",{onClick:b=>o.tempProduct.imagesUrl.splice(m,1),class:"btn btn-danger btn-sm mb-3 delete-image"},"X",8,st),t("img",{class:"img-fluid",src:o.tempProduct.imagesUrl[m]},null,8,lt)])):A("",!0)]))),128))])):A("",!0),t("button",{onClick:e[1]||(e[1]=(...l)=>o.createImages&&o.createImages(...l)),class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")])]),t("div",dt,[t("div",at,[it,n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.tempProduct.title=l),type:"text",class:"form-control mb-2",placeholder:"請輸入標題"},null,512),[[r,o.tempProduct.title]])]),t("div",nt,[t("div",ct,[rt,n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.tempProduct.category=l),type:"text",class:"form-control mb-2",placeholder:"請輸入分類"},null,512),[[r,o.tempProduct.category]])]),t("div",mt,[ut,n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.tempProduct.unit=l),type:"text",class:"form-control mb-2",placeholder:"請輸入單位"},null,512),[[r,o.tempProduct.unit]])])]),t("div",ht,[t("div",_t,[pt,n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.tempProduct.origin_price=l),min:"0",type:"number",class:"form-control mb-2",placeholder:"請輸入原價"},null,512),[[r,o.tempProduct.origin_price]])]),t("div",bt,[gt,n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.tempProduct.price=l),min:"0",type:"number",class:"form-control mb-2",placeholder:"請輸入售價"},null,512),[[r,o.tempProduct.price]])])]),Pt,t("div",ft,[vt,n(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.tempProduct.description=l),id:"description",type:"text",rows:"5",class:"form-control",placeholder:"請輸入產品描述"},`
                                                                                                                                                                                                                                                                                                                `,512),[[r,o.tempProduct.description]])]),t("div",yt,[Ut,n(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.tempProduct.content=l),id:"description",type:"text",rows:"5",class:"form-control",placeholder:"請輸入說明內容"},`
                                                                                                                                                                                                                                                                                                                `,512),[[r,o.tempProduct.content]])]),t("div",kt,[t("div",wt,[n(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.tempProduct.is_enabled=l),"true-value":1,"false-value":0,id:"is_enabled",class:"form-check-input",type:"checkbox"},null,512),[[$,o.tempProduct.is_enabled]]),Vt])])])])]),t("div",xt,[Dt,t("button",{type:"button",class:"btn btn-primary",onClick:e[10]||(e[10]=(...l)=>o.updateData&&o.updateData(...l))},"確定")])])])],512)}const At=D(R,[["render",Ct]]),Et={props:["tempProduct","delData"]},It={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Mt={class:"modal-dialog"},$t={class:"modal-content border-0"},St=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Tt={class:"modal-body"},Lt={class:"text-danger"},Nt={class:"modal-footer"},Rt=t("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"}," 取消 ",-1);function Bt(s,e,o,p,h,c){return a(),i("div",It,[t("div",Mt,[t("div",$t,[St,t("div",Tt,[E(" 是否刪除 "),t("strong",Lt,u(o.tempProduct.title),1),E(" 商品(刪除後將無法恢復)。 ")]),t("div",Nt,[Rt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...l)=>o.delData&&o.delData(...l))}," 確認刪除 ")])])])],512)}const Ht=D(Et,[["render",Bt]]),{VITE_URL:Ft,VITE_PATH:Ot}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"qaz326978547",BASE_URL:"/Vogue_Furniture/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},M=S("adminProduct",{state:()=>({products:[],pages:{},tempProduct:{imagesUrl:[]},isLoading:!1}),actions:{getAdminProduct(s=1){this.isLoading=!0,T.get(`${Ft}/api/${Ot}/admin/products?page=${s}`).then(e=>{const{products:o,pagination:p}=e.data;this.products=o,this.pages=p,this.isLoading=!1})}}}),{VITE_URL:g,VITE_PATH:P}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"qaz326978547",BASE_URL:"/Vogue_Furniture/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let _=null,V=null;const jt={data(){return{tempProduct:{},isNew:!0}},components:{AdminProductModal:At,AdminDeleteModal:Ht},methods:{...I(N,["getState"]),openModal(s,e){s=="edit"?(this.isNew=!1,this.tempProduct={...e},console.log("tempProduct-edit",this.tempProduct),_.show()):s=="new"?(this.isNew=!0,this.tempProduct={},console.log("tempProductNew",this.tempProduct),_.show()):s=="delete"&&(this.tempProduct={...e},V.show())},updateIsEnabled(s){console.log(s),this.tempProduct={...s},this.axios.put(`${g}/api/${P}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(e=>{console.log(e),this.getState("編輯成功",!0),this.getAdminProduct()})},updateData(){this.isNew?(console.log("新增產品"),this.axios.post(`${g}/api/${P}/admin/product`,{data:this.tempProduct}).then(s=>{console.log(s.data),this.getState("新增成功",!0),this.getAdminProduct(),_.hide()})):(console.log("編輯產品"),this.axios.put(`${g}/api/${P}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(s=>{console.log(s),this.getState("編輯成功",!0),this.getAdminProduct(),_.hide()}))},delData(){this.axios.delete(`${g}/api/${P}/admin/product/${this.tempProduct.id}`).then(s=>{console.log(s),this.getState("刪除成功",!0),this.getAdminProduct(),V.hide()})},createImages(){this.tempProduct.imagesUrl?this.tempProduct.imagesUrl.push(""):(this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push(""))},...I(M,["getAdminProduct"])},computed:{...L(M,["products","pages","isLoading"])},mounted(){this.getAdminProduct(),_=new C(document.getElementById("productModal")),V=new C(document.getElementById("delProductModal"))}},zt={class:"mb-5"},qt={class:"text-end mt-4"},Gt={class:"table-responsive"},Xt={class:"table mt-4"},Jt=t("thead",null,[t("tr",{class:"bg-light"},[t("th",{width:"120"},"分類"),t("th",{width:"100"},"產品名稱"),t("th",{width:"100"},"原價"),t("th",{width:"100"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Kt={class:"form-check form-switch d-flex justify-content-center"},Qt=["onChange","checked"],Wt={class:"btn-group"},Yt=["onClick"],Zt=["onClick"],te={"aria-label":"Page navigation example",class:"d-flex justify-content-center mt-3"},ee={class:"pagination"},oe=t("span",{"aria-hidden":"true"},"«",-1),se=[oe],le=["onClick"],de=t("span",{"aria-hidden":"true"},"»",-1),ae=[de];function ie(s,e,o,p,h,c){const l=y("loading"),m=y("admin-product-modal"),b=y("admin-delete-modal");return a(),i(f,null,[U(l,{active:s.isLoading,"onUpdate:active":e[0]||(e[0]=d=>s.isLoading=d)},null,8,["active"]),t("div",zt,[t("div",qt,[t("button",{class:"btn btn-primary me-5",onClick:e[1]||(e[1]=d=>c.openModal("new"))}," 建立新的產品 ")]),t("div",Gt,[t("table",Xt,[Jt,t("tbody",null,[(a(!0),i(f,null,x(s.products,d=>(a(),i("tr",{key:d.id},[t("td",null,u(d.category),1),t("td",null,u(d.title),1),t("td",null,u(d.origin_price),1),t("td",null,u(d.price),1),t("td",null,[t("div",Kt,[t("input",{onChange:v=>c.updateIsEnabled(d),checked:d.is_enabled,class:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault"},null,40,Qt)])]),t("td",null,[t("div",Wt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:v=>c.openModal("edit",d)}," 編輯 ",8,Yt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:v=>c.openModal("delete",d)}," 刪除 ",8,Zt)])])]))),128))])])]),t("nav",te,[t("ul",ee,[t("li",{class:k(["page-item",{disabled:!s.pages.has_pre}])},[t("a",{onClick:e[2]||(e[2]=w(d=>s.getAdminProduct(s.pages.current_page-1),["prevent"])),class:"page-link",href:"#","aria-label":"Previous"},se)],2),(a(!0),i(f,null,x(s.pages.total_pages,d=>(a(),i("li",{class:k(["page-item",{active:d===s.pages.current_page}]),key:d+"page"},[t("a",{onClick:w(v=>s.getAdminProduct(d),["prevent"]),class:"page-link",href:"#"},u(d),9,le)],2))),128)),t("li",{class:k(["page-item",{disabled:!s.pages.has_next}])},[t("a",{onClick:e[3]||(e[3]=w(d=>s.getAdminProduct(s.pages.current_page+1),["prevent"])),class:"page-link",href:"#","aria-label":"Next"},ae)],2)])]),U(m,{isNew:h.isNew,tempProduct:h.tempProduct,updateData:c.updateData,createImages:c.createImages},null,8,["isNew","tempProduct","updateData","createImages"]),U(b,{tempProduct:h.tempProduct,delData:c.delData},null,8,["tempProduct","delData"])])],64)}const me=D(jt,[["render",ie]]);export{me as default};
